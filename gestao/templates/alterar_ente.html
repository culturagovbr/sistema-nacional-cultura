{% extends "gestao/base_gestao.html" %} {% load gestao_tags %} {% block content %} {% load widget_tweaks %}
<div class="row">
	{{form.media}}
	<div class="col-md-12">
		<div class="card">
			<div class="card-header card-header-primary">
				<h4 class="card-title">Editar Ente</h4>
				<p class="card-category">{{object.ente_federado}}</p>
			</div>
			<div class="card-body">
				<form class="form-horizontal" method="post" enctype="multipart/form-data">{% csrf_token %}
					<select name="ente_federado" class="form-control d-none"  id="id_ente_federado">
						<option value="{{object.ente_federado.id}}" selected="">{{object.ente_federado}}</option>
					</select>
					{% include "formulario_sistema_gestao.html" %}

					<button type="submit" class="btn btn-primary pull-right">Salvar</button>
					<a class="btn btn-secondary pull-right" href="{% url 'gestao:detalhar' object.ente_federado.cod_ibge %}">Cancelar</a>
				</form>
			</div>
		</div>
	</div>
</div>

{% endblock content %}

{% block js%}
<script>

onDragEnter = function(event) {
    event.preventDefault();
},

onDragOver = function(event) {
    event.preventDefault();
},

onDragLeave = function(event) {
    event.preventDefault();
},

onDrop = function(event, a) {
	event.preventDefault();
	var inputId = $(event.target).data('target');
	var input = document.getElementById(inputId);
	var inputName = input.name
	var fileName = event.originalEvent.dataTransfer.files[0].name;
	var file = event.originalEvent.dataTransfer.files;

	$('#file-name-termo_posse').html(fileName);
	$(`#footer-${inputName}`).hide()

	input.files = event.originalEvent.dataTransfer.files;
};

$('input[type="file"]').each((key,element) => {
	$(`#${element.id}`).on("change", function(event){
		var inputName = event.target.name;
		var newFile = event.target.files[0];
		$(`#file-name-${inputName}`).html(newFile.name);
		$(`#footer-${inputName}`).hide();
	});

	$(`#drag-space-${element.name}`)
	.on("dragenter", onDragEnter)
	.on("dragover", onDragOver)
	.on("dragleave", onDragLeave)
	.on("drop", onDrop)
	.on("click", function(){
		$(`#${element.id}`).trigger('click');
	});
});

</script>
{% endblock js%}